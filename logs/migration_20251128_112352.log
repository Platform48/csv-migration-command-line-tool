2025-11-28 11:23:52,149 | INFO     | üîÅ Starting XLSX Validator and Migration
2025-11-28 11:24:18,321 | INFO     | Visible sheets: ['Journeys', 'Ground Accom', 'Location', 'Hotels Emergency Contact Info', 'Rooms Cabins', 'All Activities - For Upload', 'All Transfers - For Upload', 'PAT Cruise Packages ', 'ANT Cruise Packages', 'Excursions Package', 'Transfers - Atacama DesertEaste', 'LG and CL Activities - for Uplo', 'LG Hikes (David)', 'Private Tours Package', 'All Inclusive Hotel Package', 'Multi-day Activity Package', 'Region', 'Ship Accom', 'ANT Ship Accom', 'ANT Activities', 'ANT Transfers']
2025-11-28 11:24:36,585 | INFO     | üìã Stored auxiliary data for Rooms Cabins: 1281 rows
2025-11-28 11:24:36,588 | INFO     | üìÑ Processing Sheet: Location (1257 rows)
2025-11-28 11:24:48,329 | INFO     | ‚úÖ All rows in sheet 'Location' are valid!
2025-11-28 11:24:48,483 | INFO     | üõú Calling API ...
2025-11-28 11:26:44,429 | INFO     | ‚úÖ 614 new components uploaded from 'Location'.
2025-11-28 11:26:44,429 | INFO     | ‚ôªÔ∏è  0 components were reused from cache.
2025-11-28 11:26:44,429 | INFO     | ‚úÖ Sheet 'Location' completed in 127.84s
2025-11-28 11:26:45,210 | INFO     | 
================================================================================
MIGRATION REPORT
================================================================================
Duration: 173.06 seconds
Sheets Processed: 1

OVERALL SUMMARY
--------------------------------------------------------------------------------
Total Rows Processed: 1257
‚úÖ Successful Uploads: 614
‚ôªÔ∏è  Cached (Skipped): 0
‚ùå Total Errors: 1286
üìä Success Rate: 48.8%

SHEET: Location
--------------------------------------------------------------------------------
Total Rows: 1257
‚úÖ Successful: 614
‚ôªÔ∏è  Cached: 0
‚ùå Validation Errors: 0
‚ùå Upload Errors: 1286
‚ùå Mapping Errors: 0
üìä Success Rate: 48.8%

  Error Details:
    Row 6 (Altair Winery): upload_error
      ‚Üí {'message': "PATCH failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 451658382562311785, 'trace': 8948818607128945536}", 'status_code': 400}
    Row 6 (Altair Winery): upload_error
      ‚Üí {'message': "Upload failed: {'error': 'before create hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2007, 'span': 8900329337145134416, 'trace': 4055026647738515133}", 'status_code': 400}
    Row 43 (Caliboro Reserve Winery): upload_error
      ‚Üí {'message': "PATCH failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 7824870657825101957, 'trace': 2197919375146703206}", 'status_code': 400}
    Row 43 (Caliboro Reserve Winery): upload_error
      ‚Üí {'message': "Upload failed: {'error': 'before create hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2007, 'span': 4252156266135853654, 'trace': 4334973481916426424}", 'status_code': 400}
    Row 61 (Casa Silva Winery): upload_error
      ‚Üí {'message': "PATCH failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 5192960631602757888, 'trace': 2352227089850763536}", 'status_code': 400}
    Row 61 (Casa Silva Winery): upload_error
      ‚Üí {'message': "Upload failed: {'error': 'before create hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2007, 'span': 7604931693641598939, 'trace': 929853926064148757}", 'status_code': 400}
    Row 115 (Chill√°n Nuevo volcano): upload_error
      ‚Üí {'message': "PATCH failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 59819172678441690, 'trace': 8562696740288577758}", 'status_code': 400}
    Row 115 (Chill√°n Nuevo volcano): upload_error
      ‚Üí {'message': "Upload failed: {'error': 'before create hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2007, 'span': 6824103439645473242, 'trace': 5292511328721797033}", 'status_code': 400}
    Row 121 (Clos Apalta Winery): upload_error
      ‚Üí {'message': "PATCH failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 6482555052339038774, 'trace': 136261541651590142}", 'status_code': 400}
    Row 121 (Clos Apalta Winery): upload_error
      ‚Üí {'message': "Upload failed: {'error': 'before create hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2007, 'span': 5380323160382752632, 'trace': 112903002260299611}", 'status_code': 400}
    ... and 1276 more errors

================================================================================
2025-11-28 11:26:45,259 | INFO     | üìä Detailed JSON report saved to: logs/migration_report_20251128_112645.json
2025-11-28 11:26:45,259 | ERROR    | üí• Fatal error in main loop: 'MigrationTracker' object has no attribute 'export_to_html'
Traceback (most recent call last):
  File "C:\Users\caleb\Documents\Platform48\csv-migration-command-line-tool\app.py", line 590, in run_loop
    tracker.export_to_html(html_report_path)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationTracker' object has no attribute 'export_to_html'. Did you mean: 'export_to_json'?
