2025-11-28 11:53:18,497 | INFO     | ğŸ” Starting XLSX Validator and Migration
2025-11-28 11:53:38,621 | INFO     | Visible sheets: ['Journeys', 'Ground Accom', 'Location', 'Hotels Emergency Contact Info', 'Rooms Cabins', 'All Activities - For Upload', 'All Transfers - For Upload', 'PAT Cruise Packages ', 'ANT Cruise Packages', 'Excursions Package', 'Transfers - Atacama DesertEaste', 'LG and CL Activities - for Uplo', 'LG Hikes (David)', 'Private Tours Package', 'All Inclusive Hotel Package', 'Multi-day Activity Package', 'Region', 'Ship Accom', 'ANT Ship Accom', 'ANT Activities', 'ANT Transfers']
2025-11-28 11:53:56,204 | INFO     | ğŸ“‹ Stored auxiliary data for Rooms Cabins: 1281 rows
2025-11-28 11:53:56,210 | INFO     | ğŸ“„ Processing Sheet: Location (1257 rows)
2025-11-28 11:54:07,729 | INFO     | âœ… All rows in sheet 'Location' are valid!
2025-11-28 11:54:07,745 | INFO     | ğŸ›œ Calling API ...
2025-11-28 11:56:05,267 | INFO     | âœ… 614 new components uploaded from 'Location'.
2025-11-28 11:56:05,267 | INFO     | â™»ï¸  0 components were reused from cache.
2025-11-28 11:56:05,275 | INFO     | âœ… Sheet 'Location' completed in 129.07s
2025-11-28 11:56:05,863 | INFO     | 
================================================================================
MIGRATION REPORT
================================================================================
Duration: 167.36 seconds
Sheets Processed: 1

OVERALL SUMMARY
--------------------------------------------------------------------------------
Total Rows Processed: 1257
âœ… Successful Uploads: 614
â™»ï¸  Cached (Skipped): 0
âŒ Total Errors: 643
ğŸ“Š Success Rate: 48.8%

SHEET: Location
--------------------------------------------------------------------------------
Total Rows: 1257
âœ… Successful: 614
â™»ï¸  Cached: 0
âŒ Validation Errors: 0
âŒ Upload Errors: 643
âŒ Mapping Errors: 0
ğŸ“Š Success Rate: 48.8%

  Error Details:
    Row 6 (Altair Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 3813141894209573977, 'trace': 7899763035820230007}"}
    Row 43 (Caliboro Reserve Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 8474324091068736750, 'trace': 8974609872431332454}"}
    Row 61 (Casa Silva Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 8311537535822797666, 'trace': 6621276819260394045}"}
    Row 121 (Clos Apalta Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 7347877974170939653, 'trace': 8411054173781766335}"}
    Row 115 (ChillÃ¡n Nuevo volcano): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 3845325463437225709, 'trace': 6412999472282387245}"}
    Row 222 (Haras de Pirque Vineyard): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 789178424648419070, 'trace': 8957346496524086979}"}
    Row 339 (Lapostolle Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 7902036812931420671, 'trace': 4597701445500789322}"}
    Row 361 (Mendoza): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 4240930672340572424, 'trace': 4335662908386433886}"}
    Row 377 (Montes Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 6288926632475029858, 'trace': 5986409811081108233}"}
    Row 411 (Perez Cruz Vineyard): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 6823879105049778924, 'trace': 8802001982242835275}"}
    ... and 633 more errors

================================================================================
2025-11-28 11:56:05,896 | INFO     | ğŸ“Š Detailed JSON report saved to: logs/migration_report_20251128_115605.json
2025-11-28 11:56:05,896 | ERROR    | ğŸ’¥ Fatal error in main loop: 'MigrationTracker' object has no attribute 'export_to_html'
Traceback (most recent call last):
  File "C:\Users\caleb\Documents\Platform48\csv-migration-command-line-tool\app.py", line 628, in run_loop
    tracker.export_to_html(html_report_path)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationTracker' object has no attribute 'export_to_html'. Did you mean: 'export_to_json'?
