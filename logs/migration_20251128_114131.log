2025-11-28 11:41:31,406 | INFO     | ğŸ” Starting XLSX Validator and Migration
2025-11-28 11:41:51,621 | INFO     | Visible sheets: ['Journeys', 'Ground Accom', 'Location', 'Hotels Emergency Contact Info', 'Rooms Cabins', 'All Activities - For Upload', 'All Transfers - For Upload', 'PAT Cruise Packages ', 'ANT Cruise Packages', 'Excursions Package', 'Transfers - Atacama DesertEaste', 'LG and CL Activities - for Uplo', 'LG Hikes (David)', 'Private Tours Package', 'All Inclusive Hotel Package', 'Multi-day Activity Package', 'Region', 'Ship Accom', 'ANT Ship Accom', 'ANT Activities', 'ANT Transfers']
2025-11-28 11:42:09,863 | INFO     | ğŸ“‹ Stored auxiliary data for Rooms Cabins: 1281 rows
2025-11-28 11:42:09,871 | INFO     | ğŸ“„ Processing Sheet: Location (1257 rows)
2025-11-28 11:42:21,836 | INFO     | âœ… All rows in sheet 'Location' are valid!
2025-11-28 11:42:21,965 | INFO     | ğŸ›œ Calling API ...
2025-11-28 11:44:17,010 | INFO     | âœ… 614 new components uploaded from 'Location'.
2025-11-28 11:44:17,010 | INFO     | â™»ï¸  0 components were reused from cache.
2025-11-28 11:44:17,011 | INFO     | âœ… Sheet 'Location' completed in 127.14s
2025-11-28 11:44:17,570 | INFO     | 
================================================================================
MIGRATION REPORT
================================================================================
Duration: 166.16 seconds
Sheets Processed: 1

OVERALL SUMMARY
--------------------------------------------------------------------------------
Total Rows Processed: 1257
âœ… Successful Uploads: 614
â™»ï¸  Cached (Skipped): 0
âŒ Total Errors: 643
ğŸ“Š Success Rate: 48.8%

SHEET: Location
--------------------------------------------------------------------------------
Total Rows: 1257
âœ… Successful: 614
â™»ï¸  Cached: 0
âŒ Validation Errors: 0
âŒ Upload Errors: 643
âŒ Mapping Errors: 0
ğŸ“Š Success Rate: 48.8%

  Error Details:
    Row 6 (Altair Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 4990844656780694057, 'trace': 1154580589564670449}"}
    Row 43 (Caliboro Reserve Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 3762171839201023075, 'trace': 3784801209806232581}"}
    Row 61 (Casa Silva Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 2640885499225424461, 'trace': 2173256378436607771}"}
    Row 115 (ChillÃ¡n Nuevo volcano): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 3041099052495133646, 'trace': 1025884992249020715}"}
    Row 121 (Clos Apalta Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 5297904088405466014, 'trace': 4298496397775863960}"}
    Row 222 (Haras de Pirque Vineyard): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 3156770375095108175, 'trace': 1999786318564710056}"}
    Row 339 (Lapostolle Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 8122182190123108660, 'trace': 7493827477530555642}"}
    Row 361 (Mendoza): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 3450190233569375002, 'trace': 4724165795415719880}"}
    Row 377 (Montes Winery): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 6945070858723999282, 'trace': 1062064128328522768}"}
    Row 411 (Perez Cruz Vineyard): upload_error
      â†’ {'message': "Upload failed: {'error': 'before update hook failed: failed to validate entity during database operation: component type requires at least one region', 'code': 2005, 'span': 2560297471467223790, 'trace': 7361610751281113090}"}
    ... and 633 more errors

================================================================================
2025-11-28 11:44:17,604 | INFO     | ğŸ“Š Detailed JSON report saved to: logs/migration_report_20251128_114417.json
2025-11-28 11:44:17,606 | ERROR    | ğŸ’¥ Fatal error in main loop: 'MigrationTracker' object has no attribute 'export_to_html'
Traceback (most recent call last):
  File "C:\Users\caleb\Documents\Platform48\csv-migration-command-line-tool\app.py", line 589, in run_loop
    tracker.export_to_html(html_report_path)
    ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MigrationTracker' object has no attribute 'export_to_html'. Did you mean: 'export_to_json'?
